# Story 1.0: External Services Setup & User Prerequisites

## Status
Ready for Development

## Story

**As a** project owner,
**I want** to complete all external service setup and account creation tasks,
**so that** the development agent has all necessary credentials and access to proceed with implementation.

## Acceptance Criteria

1. Google OAuth application created and configured with proper redirect URIs
2. Stripe account created with API keys obtained (test and production)
3. Domain name registered and DNS configured for the application
4. Email service provider account created (SendGrid/AWS SES/Postmark)
5. Cloud provider account setup (AWS/GCP) with billing configured
6. Fantrax API access requested and credentials obtained (if available)
7. All credentials securely stored and documented for agent access
8. Backup service alternatives identified for each external dependency

## Tasks / Subtasks

### User-Only Tasks (Must be completed by human)

- [ ] Task 1: Google OAuth Setup (AC: 1)
  - [ ] Go to Google Cloud Console (https://console.cloud.google.com)
  - [ ] Create new project or select existing project
  - [ ] Enable Google+ API and OAuth 2.0
  - [ ] Create OAuth 2.0 credentials (Web application type)
  - [ ] Add authorized redirect URIs:
    - `http://localhost:3000/auth/google/callback` (development)
    - `https://yourdomain.com/auth/google/callback` (production)
  - [ ] Download credentials JSON
  - [ ] Document Client ID and Client Secret in secure location

- [ ] Task 2: Stripe Account Setup (AC: 2)
  - [ ] Create Stripe account at https://stripe.com
  - [ ] Complete business verification (if required)
  - [ ] Navigate to Developers > API Keys
  - [ ] Copy Test Mode keys:
    - Publishable key (starts with pk_test_)
    - Secret key (starts with sk_test_)
  - [ ] Set up webhook endpoint secret for local testing
  - [ ] Document Production keys separately (do not use until ready)

- [ ] Task 3: Domain Registration & DNS (AC: 3)
  - [ ] Register domain name (e.g., afinewinedynasty.com)
  - [ ] Configure DNS with your registrar or Cloudflare
  - [ ] Set up subdomain for API if needed (api.yourdomain.com)
  - [ ] Document nameserver configuration
  - [ ] Plan for SSL certificate (Let's Encrypt or CloudFlare)

- [ ] Task 4: Email Service Provider (AC: 4)
  - [ ] Choose provider (recommended order):
    - Option A: SendGrid (easy setup, good free tier)
    - Option B: AWS SES (cheapest at scale, more complex)
    - Option C: Postmark (great deliverability, simple API)
  - [ ] Create account and verify domain
  - [ ] Generate API key for transactional emails
  - [ ] Set up sender authentication (SPF, DKIM)
  - [ ] Create email templates for:
    - Welcome email
    - Password reset
    - Payment failed
    - Subscription confirmation

- [ ] Task 5: Cloud Provider Setup (AC: 5)
  - [ ] Create AWS or GCP account
  - [ ] Set up billing alerts
  - [ ] Create IAM user for deployment (not root account)
  - [ ] Generate access keys for CI/CD
  - [ ] Set up initial resource quotas/limits
  - [ ] Document region selection (us-east-1 recommended for start)

- [ ] Task 6: Fantrax API Access (AC: 6) [OPTIONAL - May defer to Epic 4]
  - [ ] Contact Fantrax support for API access
  - [ ] Complete any required partnership agreements
  - [ ] Obtain API credentials if available
  - [ ] Document any rate limits or restrictions
  - [ ] Note: If not immediately available, implement mock for development

### Developer Agent Tasks (After user tasks complete)

- [ ] Task 7: Credential Management Setup (AC: 7)
  - [ ] Create `.env.local` with all development credentials
  - [ ] Create `.env.production` template (without actual secrets)
  - [ ] Set up secrets management in CI/CD (GitHub Secrets)
  - [ ] Document credential rotation policy
  - [ ] Test all external service connections

- [ ] Task 8: Fallback Strategy Documentation (AC: 8)
  - [ ] Document offline development mode for each service
  - [ ] Create mock services for testing without external APIs
  - [ ] Define graceful degradation for service failures
  - [ ] Set up monitoring for external service health

## Dev Notes

### Critical Information
**This story MUST be completed by the user before any development begins.** The developer agent cannot:
- Create accounts on external services
- Provide payment information
- Agree to terms of service
- Register domain names

### Credential Storage
All credentials should be stored in a secure password manager and made available to the developer agent through:
1. Environment variables in `.env.local`
2. GitHub Secrets for CI/CD
3. Never commit credentials to version control

### Estimated Time
- User tasks: 2-4 hours
- Developer tasks: 1-2 hours

### Dependencies
This story has no dependencies but blocks ALL other stories in Epic 1.

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2024-10-02 | 1.0 | Initial story creation | Sarah (PO) |

## QA Results

### Review Date: 2025-10-02

### Reviewed By: Quinn (Test Architect)

### Code Quality Assessment

Story 1.0 is a prerequisites story focused on external service setup that must be completed by the user. This is not a development story with code implementation, but rather a critical dependency for the entire project. The story is well-structured with clear user-only tasks and developer follow-up tasks.

### Story Type Analysis

- **Type**: Infrastructure Prerequisites / User Setup Story
- **Implementation**: No code implementation yet (Status: Ready for Development)
- **Critical Path**: Blocks ALL Epic 1 stories

### Compliance Check

- Story Structure: ✓ Well-formatted with clear AC and task breakdown
- Task Organization: ✓ Clear separation between user and developer tasks
- Documentation: ✓ Comprehensive notes on credential management
- Prerequisites: ✓ Properly identifies as blocking dependency

### Risk Assessment

**HIGH RISK AREAS:**
- External service dependencies create single points of failure
- Credential management requires secure handling
- No fallback mechanisms defined for service unavailability
- Developer tasks cannot begin until user completes setup

### Requirements Coverage Analysis

Since no implementation exists yet, I'm analyzing the planned coverage:

1. **AC1 (Google OAuth)**: Clear setup steps provided
2. **AC2 (Stripe)**: Comprehensive payment setup included
3. **AC3 (Domain/DNS)**: Basic setup covered, SSL planning mentioned
4. **AC4 (Email Service)**: Multiple provider options given
5. **AC5 (Cloud Provider)**: AWS/GCP setup with IAM considerations
6. **AC6 (Fantrax API)**: Marked as optional with mock fallback
7. **AC7 (Credential Storage)**: Security practices documented
8. **AC8 (Backup Services)**: Developer task planned but not detailed

### Security Considerations

- ✓ Emphasis on secure credential storage
- ✓ Separation of test/production credentials
- ✓ IAM user creation (not root account)
- ⚠️ Missing: Credential rotation policy
- ⚠️ Missing: Secrets scanning in CI/CD

### Improvements Checklist

- [ ] Add credential rotation schedule documentation
- [ ] Define specific fallback services for each external dependency
- [ ] Add monitoring setup for external service health
- [ ] Include cost estimation for external services
- [ ] Add rollback plan if services become unavailable
- [ ] Document data privacy implications for each service

### Gate Status

Gate: **PASS** → docs/qa/gates/1.0-external-services-setup.yml
Status Reason: Prerequisites story appropriately structured for user completion. No code to review yet.

### Recommended Status

[✓ Ready for User Completion] - User must complete all setup tasks before development can begin